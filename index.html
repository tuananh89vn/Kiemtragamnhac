<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tr√≤ Ch∆°i H·ªçc Nh·ªãp 4/4</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fbb6ce 0%, #f687b3 50%, #ed64a6 100%);
            background-attachment: fixed;
            min-height: 100%;
            color: #2d3748;
            position: relative;
            overflow-x: hidden;
        }

        /* Floating musical notes animation */
        body::before {
            content: 'üéµ üé∂ üéº üéπ üé∫ üé∏ ü•Å üé§';
            position: fixed;
            top: -50px;
            left: -50px;
            right: -50px;
            bottom: -50px;
            font-size: 2rem;
            opacity: 0.1;
            animation: floatingNotes 20s linear infinite;
            pointer-events: none;
            z-index: 0;
            white-space: nowrap;
            overflow: hidden;
        }

        @keyframes floatingNotes {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-100vh) rotate(360deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 
                0 30px 60px rgba(237, 100, 166, 0.2),
                0 15px 30px rgba(246, 135, 179, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.4);
            position: relative;
            z-index: 1;
            animation: containerGlow 4s ease-in-out infinite alternate;
        }

        @keyframes containerGlow {
            0% { 
                box-shadow: 
                    0 30px 60px rgba(237, 100, 166, 0.2),
                    0 15px 30px rgba(246, 135, 179, 0.15),
                    inset 0 1px 0 rgba(255, 255, 255, 0.8);
            }
            100% { 
                box-shadow: 
                    0 35px 70px rgba(237, 100, 166, 0.3),
                    0 20px 40px rgba(246, 135, 179, 0.25),
                    inset 0 1px 0 rgba(255, 255, 255, 0.9);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            padding: 20px 0;
        }

        .header::before {
            content: 'üéº‚ú®üéµ‚ú®üé∂‚ú®üéº';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.5rem;
            animation: sparkle 2s ease-in-out infinite;
            background: linear-gradient(45deg, #ed64a6, #f687b3, #fbb6ce);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 3px;
            background: linear-gradient(90deg, #ed64a6, #f687b3, #fbb6ce, #f687b3, #ed64a6);
            border-radius: 2px;
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0.7; transform: translateX(-50%) scale(1); }
            50% { opacity: 1; transform: translateX(-50%) scale(1.1); }
        }

        @keyframes shimmer {
            0% { background-position: -150px 0; }
            100% { background-position: 150px 0; }
        }

        .game-title {
            font-size: 3.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #ed64a6 0%, #f687b3 30%, #fbb6ce 60%, #ed64a6 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            letter-spacing: -1px;
            animation: titleGradient 4s ease-in-out infinite, titleBounce 6s ease-in-out infinite;
            text-shadow: 0 0 30px rgba(237, 100, 166, 0.3);
            position: relative;
        }

        .game-title::before {
            content: 'üéµ√ÇM NH·∫†C - NH·ªäP 4/4üéµ';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, rgba(237, 100, 166, 0.2), rgba(246, 135, 179, 0.2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: blur(2px);
            z-index: -1;
        }

        @keyframes titleGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes titleBounce {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .welcome-text {
            font-size: 1.3rem;
            color: #718096;
            margin-bottom: 20px;
            font-weight: 400;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 10px;
            box-shadow: 
                0 10px 40px rgba(237, 100, 166, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .tabs::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(237, 100, 166, 0.1), transparent);
            animation: tabsShine 3s ease-in-out infinite;
        }

        @keyframes tabsShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .tab {
            padding: 18px 30px;
            margin: 0 8px;
            border: none;
            border-radius: 18px;
            background: transparent;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            color: #4a5568;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(237, 100, 166, 0.2), transparent);
            transition: left 0.6s ease;
            z-index: -1;
        }

        .tab:hover {
            transform: translateY(-2px);
            color: #ed64a6;
            background: rgba(237, 100, 166, 0.1);
            box-shadow: 0 8px 25px rgba(237, 100, 166, 0.2);
        }

        .tab:hover::before {
            left: 100%;
        }

        .tab.active {
            background: linear-gradient(135deg, #ed64a6 0%, #f687b3 50%, #fbb6ce 100%);
            color: white;
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(237, 100, 166, 0.4);
            animation: tabPulse 2s ease-in-out infinite;
        }

        @keyframes tabPulse {
            0%, 100% { box-shadow: 0 12px 30px rgba(237, 100, 166, 0.4); }
            50% { box-shadow: 0 15px 35px rgba(237, 100, 166, 0.6); }
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Rhythm Simulator */
        .rhythm-simulator {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, rgba(255, 236, 210, 0.9) 0%, rgba(252, 182, 159, 0.9) 100%);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .simulator-header {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .theory-toggle {
            padding: 12px 24px;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.3);
        }

        .theory-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(66, 153, 225, 0.4);
        }

        .theory-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: left;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            display: none;
            animation: slideDown 0.5s ease;
        }

        .theory-panel.show {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .theory-panel h3 {
            color: #2d3748;
            font-size: 1.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theory-panel h4 {
            color: #4a5568;
            font-size: 1.2rem;
            margin: 20px 0 10px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .theory-panel ul {
            margin: 15px 0;
            padding-left: 20px;
        }

        .theory-panel li {
            margin: 8px 0;
            line-height: 1.6;
        }

        .example-box {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #ebf8ff 0%, #bee3f8 100%);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #4299e1;
            margin: 15px 0;
        }

        .beat-display {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .beat {
            width: 110px;
            height: 110px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.9rem;
            font-weight: 700;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border: 4px solid rgba(255,255,255,0.4);
            position: relative;
            overflow: hidden;
            animation: beatFloat 3s ease-in-out infinite;
        }

        .beat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, rgba(255,255,255,0.4) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .beat::after {
            content: '‚ô™';
            position: absolute;
            top: -10px;
            right: -10px;
            font-size: 1.2rem;
            opacity: 0;
            animation: noteFloat 2s ease-in-out infinite;
            color: rgba(237, 100, 166, 0.8);
        }

        .beat:hover {
            transform: scale(1.05) translateY(-5px);
            border-color: rgba(255,255,255,0.8);
        }

        .beat:hover::before {
            opacity: 1;
        }

        .beat:hover::after {
            opacity: 1;
        }

        @keyframes beatFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }

        @keyframes noteFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.6; }
            50% { transform: translateY(-8px) rotate(10deg); opacity: 1; }
        }

        .beat small {
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 5px;
        }

        .beat.strong {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(229, 62, 62, 0.3);
        }

        .beat.weak {
            background: linear-gradient(135deg, #90cdf4 0%, #63b3ed 100%);
            color: #2d3748;
            box-shadow: 0 8px 25px rgba(144, 205, 244, 0.3);
        }

        .beat.medium {
            background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(246, 173, 85, 0.3);
        }

        .beat.active {
            transform: scale(1.25) translateY(-8px);
            box-shadow: 
                0 20px 50px rgba(229, 62, 62, 0.6),
                0 0 30px rgba(237, 100, 166, 0.4);
            border-color: rgba(255,255,255,1);
            animation: beatActive 0.6s ease-in-out, beatFloat 3s ease-in-out infinite;
        }

        .beat.active::before {
            opacity: 1;
            background: radial-gradient(circle at center, rgba(255,255,255,0.6) 0%, transparent 70%);
        }

        .beat.active::after {
            opacity: 1;
            animation: noteActive 0.6s ease-in-out, noteFloat 2s ease-in-out infinite;
        }

        @keyframes beatActive {
            0% { transform: scale(1) translateY(0px); }
            50% { transform: scale(1.3) translateY(-10px); }
            100% { transform: scale(1.25) translateY(-8px); }
        }

        @keyframes noteActive {
            0% { transform: translateY(0px) rotate(0deg) scale(1); }
            50% { transform: translateY(-15px) rotate(20deg) scale(1.3); }
            100% { transform: translateY(-8px) rotate(10deg) scale(1.1); }
        }

        .controls {
            margin: 30px 0;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            min-width: 120px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ed64a6 0%, #f687b3 50%, #fbb6ce 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(237, 100, 166, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn-primary::after {
            content: '‚ô™';
            position: absolute;
            top: 50%;
            right: 15px;
            transform: translateY(-50%);
            opacity: 0;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .btn-primary:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(237, 100, 166, 0.5);
            background: linear-gradient(135deg, #f687b3 0%, #ed64a6 50%, #d53f8c 100%);
        }

        .btn-primary:hover::after {
            opacity: 1;
            transform: translateY(-50%) rotate(15deg);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f687b3 0%, #ed64a6 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(246, 135, 179, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn-secondary::after {
            content: '‚ô´';
            position: absolute;
            top: 50%;
            right: 15px;
            transform: translateY(-50%);
            opacity: 0;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .btn-secondary:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(246, 135, 179, 0.5);
            background: linear-gradient(135deg, #ed64a6 0%, #d53f8c 100%);
        }

        .btn-secondary:hover::after {
            opacity: 1;
            transform: translateY(-50%) rotate(-15deg);
        }

        .tempo-control {
            margin: 30px 0;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .tempo-control label {
            font-size: 1.2rem;
            font-weight: 600;
            color: #4a5568;
            margin-right: 15px;
        }

        .tempo-slider {
            width: 300px;
            height: 8px;
            margin: 0 20px;
            background: linear-gradient(90deg, #e2e8f0, #cbd5e0);
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
        }

        .tempo-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.4);
            transition: all 0.3s ease;
        }

        .tempo-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 20px rgba(66, 153, 225, 0.6);
        }

        .tempo-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.4);
        }

        #tempoDisplay {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2d3748;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Quiz Section */
        .quiz-container {
            background: linear-gradient(135deg, rgba(168, 237, 234, 0.9) 0%, rgba(254, 214, 227, 0.9) 100%);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 40px;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .question {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .question h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .options {
            display: grid;
            gap: 12px;
        }

        .option {
            padding: 18px 20px;
            border: 2px solid rgba(226, 232, 240, 0.8);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(247, 250, 252, 0.8);
            backdrop-filter: blur(5px);
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .option:hover::before {
            left: 100%;
        }

        .option:hover {
            border-color: #4299e1;
            background: rgba(235, 248, 255, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(66, 153, 225, 0.2);
        }

        .option.selected {
            border-color: #4299e1;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(66, 153, 225, 0.4);
        }

        .option.correct {
            border-color: #48bb78;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(72, 187, 120, 0.4);
        }

        .option.incorrect {
            border-color: #f56565;
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(245, 101, 101, 0.4);
        }

        /* AI Teacher */
        .ai-teacher {
            background: linear-gradient(135deg, rgba(210, 153, 194, 0.9) 0%, rgba(254, 249, 215, 0.9) 100%);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 40px;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .teacher-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            box-shadow: 0 15px 35px rgba(66, 153, 225, 0.3);
            border: 4px solid rgba(255,255,255,0.3);
            position: relative;
            overflow: hidden;
        }

        .teacher-avatar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, rgba(255,255,255,0.2) 0%, transparent 70%);
        }

        .ai-teacher-icon {
            width: 80px;
            height: 80px;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2));
        }

        .chat-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-top: 25px;
            max-height: 400px;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .message {
            margin-bottom: 20px;
            padding: 18px 22px;
            border-radius: 15px;
            line-height: 1.6;
            font-weight: 500;
        }

        .message.user {
            background: linear-gradient(135deg, rgba(235, 248, 255, 0.9) 0%, rgba(190, 227, 248, 0.9) 100%);
            margin-left: 30px;
            border-left: 4px solid #4299e1;
        }

        .message.ai {
            background: linear-gradient(135deg, rgba(240, 255, 244, 0.9) 0%, rgba(198, 246, 213, 0.9) 100%);
            margin-right: 30px;
            border-left: 4px solid #48bb78;
        }

        .input-container {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .question-input {
            flex: 1;
            padding: 18px 20px;
            border: 2px solid rgba(226, 232, 240, 0.8);
            border-radius: 15px;
            font-size: 1.1rem;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .question-input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
            background: rgba(255, 255, 255, 1);
        }

        .score-display {
            text-align: center;
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 25px 0;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(226, 232, 240, 0.8);
            border-radius: 6px;
            overflow: hidden;
            margin: 25px 0;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78 0%, #38a169 50%, #2f855a 100%);
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 6px;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Conducting Diagram Styles */
        .conducting-diagram {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .conducting-pattern {
            text-align: center;
            margin-bottom: 25px;
        }

        .conducting-pattern svg {
            max-width: 100%;
            height: auto;
            background: rgba(247, 250, 252, 0.8);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .beat-label {
            font-size: 12px;
            font-weight: 600;
            fill: #4a5568;
            font-family: 'Segoe UI', sans-serif;
        }

        .conducting-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .tempo-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tempo-info label {
            font-size: 1rem;
            font-weight: 600;
            color: #4a5568;
        }

        #conductingTempo {
            width: 200px;
            height: 6px;
            background: linear-gradient(90deg, #e2e8f0, #cbd5e0);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        #conductingTempo::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        #conductingTempo::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.6);
        }

        #conductingTempo::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.4);
        }

        #conductingTempoDisplay {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2d3748;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .conducting-instructions {
            background: linear-gradient(135deg, rgba(235, 248, 255, 0.9) 0%, rgba(190, 227, 248, 0.9) 100%);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #4299e1;
        }

        .conducting-instructions h5 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .conducting-instructions ol {
            margin: 0;
            padding-left: 20px;
        }

        .conducting-instructions li {
            margin: 8px 0;
            line-height: 1.6;
            font-weight: 500;
        }

        /* Enhanced Conducting Diagram Styles */
        .beat-label-main {
            font-size: 16px;
            font-weight: bold;
            fill: #2d3748;
            font-family: 'Segoe UI', sans-serif;
        }

        .beat-label-sub {
            font-size: 11px;
            font-weight: 600;
            fill: #4a5568;
            font-family: 'Segoe UI', sans-serif;
        }

        .indicator-label {
            font-size: 10px;
            font-weight: 500;
            fill: #4a5568;
            font-family: 'Segoe UI', sans-serif;
        }

        .conductor-label {
            font-size: 12px;
        }

        .control-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .conducting-btn {
            min-width: 200px;
        }

        .tempo-control-advanced {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .tempo-presets {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .tempo-preset {
            padding: 8px 16px;
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e0 100%);
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #4a5568;
        }

        .tempo-preset:hover {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.3);
        }

        .instruction-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .instruction-item {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.6);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #4299e1;
            transition: all 0.3s ease;
        }

        .instruction-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.2);
            background: rgba(255, 255, 255, 0.8);
        }

        .instruction-icon {
            font-size: 1.5rem;
            min-width: 30px;
            text-align: center;
        }

        .instruction-content {
            flex: 1;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .instruction-content strong {
            color: #2d3748;
            display: block;
            margin-bottom: 4px;
        }

        /* Animation states for conducting */
        .conducting-paused #conductorHand animateMotion {
            animation-play-state: paused;
        }

        .conducting-active #conductorHand animateMotion {
            animation-play-state: running;
        }

        /* Beat indicator animations */
        .beat-indicator-active {
            opacity: 1 !important;
            transform: scale(1.2);
            transition: all 0.2s ease;
        }

        /* Theory Page Styles */
        .theory-container {
            background: linear-gradient(135deg, rgba(235, 248, 255, 0.9) 0%, rgba(190, 227, 248, 0.9) 100%);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 40px;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .theory-container h2 {
            text-align: center;
            color: #2d3748;
            font-size: 2.5rem;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Theory Layout */
        .theory-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .theory-left-column,
        .theory-right-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .theory-section.compact {
            margin-bottom: 0;
        }

        .theory-section.full-width {
            grid-column: 1 / -1;
            margin-top: 20px;
        }

        .highlight-box.compact {
            margin: 15px 0;
            padding: 15px;
        }

        .beat-structure-grid.compact {
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .beat-structure-grid.compact .beat-card {
            padding: 15px;
        }

        .beat-structure-grid.compact .beat-number {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }

        .beat-structure-grid.compact .beat-type {
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .beat-structure-grid.compact .beat-description {
            font-size: 0.85rem;
        }

        .applications-grid.compact {
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .applications-grid.compact .genre-card {
            padding: 15px;
        }

        .applications-grid.compact .genre-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        .applications-grid.compact .genre-name {
            font-size: 1rem;
        }

        .applications-grid.compact .genre-description {
            display: none;
        }

        .examples-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .conducting-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }

        .conducting-btn {
            min-width: 200px;
        }

        .theory-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .section-header {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            padding: 20px 30px;
            color: white;
        }

        .section-header h3 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .theory-content {
            padding: 30px;
        }

        .highlight-box {
            background: linear-gradient(135deg, rgba(240, 255, 244, 0.9) 0%, rgba(198, 246, 213, 0.9) 100%);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #48bb78;
            margin: 20px 0;
        }

        .highlight-box h4 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .highlight-box ul {
            margin: 0;
            padding-left: 20px;
        }

        .highlight-box li {
            margin: 8px 0;
            line-height: 1.6;
            font-weight: 500;
        }

        /* Beat Structure Grid */
        .beat-structure-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .beat-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .beat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .beat-card.strong-beat {
            border-color: #e53e3e;
            background: linear-gradient(135deg, rgba(254, 178, 178, 0.3) 0%, rgba(252, 129, 129, 0.3) 100%);
        }

        .beat-card.medium-beat {
            border-color: #f6ad55;
            background: linear-gradient(135deg, rgba(254, 215, 170, 0.3) 0%, rgba(251, 191, 36, 0.3) 100%);
        }

        .beat-card.weak-beat {
            border-color: #63b3ed;
            background: linear-gradient(135deg, rgba(190, 227, 248, 0.3) 0%, rgba(144, 205, 244, 0.3) 100%);
        }

        .beat-number {
            font-size: 3rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .beat-type {
            font-size: 1.1rem;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .beat-description {
            font-size: 0.9rem;
            color: #718096;
            line-height: 1.4;
        }

        /* Applications Grid */
        .applications-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .genre-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid rgba(66, 153, 225, 0.2);
        }

        .genre-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(66, 153, 225, 0.2);
            border-color: #4299e1;
        }

        .genre-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .genre-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .genre-description {
            font-size: 0.9rem;
            color: #718096;
            line-height: 1.4;
        }

        /* Song Examples */
        .song-examples {
            margin: 15px 0;
        }

        .song-item {
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #4299e1;
            transition: all 0.3s ease;
        }

        .song-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.2);
        }

        .song-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .song-description {
            font-size: 0.9rem;
            color: #718096;
        }

        .tip-box {
            background: linear-gradient(135deg, rgba(255, 236, 210, 0.9) 0%, rgba(252, 182, 159, 0.9) 100%);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #f6ad55;
            margin: 20px 0;
        }

        .tip-box h5 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .tip-box ul {
            margin: 0;
            padding-left: 20px;
        }

        .tip-box li {
            margin: 8px 0;
            line-height: 1.6;
            font-weight: 500;
        }

        /* Game Styles */
        .game-container {
            background: linear-gradient(135deg, rgba(168, 237, 234, 0.9) 0%, rgba(254, 214, 227, 0.9) 100%);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 40px;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .game-screen {
            display: none;
            animation: fadeInGame 0.5s ease;
        }

        .game-screen.active {
            display: block;
        }

        @keyframes fadeInGame {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .game-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .game-header h2 {
            color: #2d3748;
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .game-subtitle {
            color: #718096;
            font-size: 1.2rem;
            font-weight: 500;
        }

        /* Musical Notes Decoration */
        .musical-notes-decoration {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .floating-note {
            position: absolute;
            font-size: 2rem;
            opacity: 0.1;
            animation: floatNote 8s ease-in-out infinite;
        }

        .note-1 { top: 10%; left: 10%; animation-delay: 0s; }
        .note-2 { top: 20%; right: 15%; animation-delay: 1s; }
        .note-3 { top: 60%; left: 5%; animation-delay: 2s; }
        .note-4 { bottom: 20%; right: 10%; animation-delay: 3s; }
        .note-5 { top: 40%; left: 80%; animation-delay: 4s; }
        .note-6 { bottom: 10%; left: 20%; animation-delay: 5s; }

        @keyframes floatNote {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.1; }
            50% { transform: translateY(-20px) rotate(10deg); opacity: 0.3; }
        }

        /* Game Packages */
        .game-packages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .package-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 3px solid transparent;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .package-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.6s;
        }

        .package-card:hover::before {
            left: 100%;
        }

        .package-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }

        .package-card.easy {
            border-color: #48bb78;
            background: linear-gradient(135deg, rgba(240, 255, 244, 0.95) 0%, rgba(198, 246, 213, 0.95) 100%);
        }

        .package-card.easy:hover {
            border-color: #38a169;
            box-shadow: 0 20px 50px rgba(72, 187, 120, 0.3);
        }

        .package-card.medium {
            border-color: #f6ad55;
            background: linear-gradient(135deg, rgba(255, 236, 210, 0.95) 0%, rgba(252, 182, 159, 0.95) 100%);
        }

        .package-card.medium:hover {
            border-color: #ed8936;
            box-shadow: 0 20px 50px rgba(246, 173, 85, 0.3);
        }

        .package-card.hard {
            border-color: #9f7aea;
            background: linear-gradient(135deg, rgba(245, 240, 255, 0.95) 0%, rgba(221, 214, 254, 0.95) 100%);
        }

        .package-card.hard:hover {
            border-color: #805ad5;
            box-shadow: 0 20px 50px rgba(159, 122, 234, 0.3);
        }

        .package-card.completed {
            opacity: 0.5;
            transform: scale(0.95);
            cursor: not-allowed;
            filter: grayscale(0.7);
        }

        .package-card.completed::after {
            content: '‚úÖ Ho√†n Th√†nh';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(72, 187, 120, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .package-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2));
        }

        .package-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .package-description {
            color: #718096;
            font-size: 1rem;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .progress-stars {
            display: flex;
            justify-content: center;
            gap: 5px;
        }

        .star {
            font-size: 1.2rem;
            filter: drop-shadow(0 2px 5px rgba(0,0,0,0.2));
        }

        /* Start Game Button */
        .start-game-section {
            text-align: center;
        }

        .start-game-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 20px 50px;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 0 auto;
        }

        .start-game-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .start-game-btn:hover::before {
            left: 100%;
        }

        .start-game-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 50px rgba(102, 126, 234, 0.5);
        }

        .btn-text {
            font-size: 1.5rem;
        }

        .btn-icon {
            font-size: 1.8rem;
            animation: rocketBounce 2s ease-in-out infinite;
        }

        @keyframes rocketBounce {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        /* Instructions Screen */
        .instructions-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .instructions-content h3 {
            text-align: center;
            color: #2d3748;
            font-size: 2rem;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .instruction-list {
            margin-bottom: 30px;
        }

        .instruction-item {
            display: flex;
            align-items: center;
            gap: 20px;
            background: rgba(235, 248, 255, 0.8);
            padding: 20px;
            margin: 15px 0;
            border-radius: 15px;
            border-left: 4px solid #4299e1;
            transition: all 0.3s ease;
        }

        .instruction-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.2);
        }

        .instruction-number {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.3);
        }

        .instruction-text {
            flex: 1;
            font-size: 1.1rem;
            color: #2d3748;
            font-weight: 500;
        }

        .instructions-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        /* Game Play Screen */
        .game-header-play {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 20px 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .game-progress-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .game-progress-info span {
            font-weight: 600;
            color: #2d3748;
        }

        #currentPackageTitle {
            font-size: 1.3rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        #questionCounter {
            font-size: 1rem;
            color: #718096;
        }

        .game-lives {
            font-size: 1.5rem;
        }

        /* Question Container */
        .question-container-game {
            margin-bottom: 30px;
        }

        .question-card {
            background: linear-gradient(135deg, rgba(245, 240, 255, 0.95) 0%, rgba(221, 214, 254, 0.95) 100%);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(159, 122, 234, 0.2);
            border: 2px solid rgba(159, 122, 234, 0.3);
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 30px;
            text-align: center;
            line-height: 1.6;
        }

        .question-options {
            display: grid;
            gap: 15px;
        }

        .game-option {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border: 3px solid rgba(159, 122, 234, 0.3);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.1rem;
            font-weight: 500;
            color: #2d3748;
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        .game-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(159, 122, 234, 0.2), transparent);
            transition: left 0.5s;
        }

        .game-option:hover::before {
            left: 100%;
        }

        .game-option:hover {
            transform: translateY(-3px) rotateX(5deg);
            border-color: #9f7aea;
            box-shadow: 0 10px 25px rgba(159, 122, 234, 0.3);
            background: rgba(245, 240, 255, 0.95);
        }

        .game-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .game-option.correct {
            border-color: #48bb78;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            animation: correctPulse 0.6s ease;
        }

        .game-option.incorrect {
            border-color: #f56565;
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            color: white;
            animation: incorrectShake 0.6s ease;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Game Controls */
        .game-controls {
            text-align: center;
            margin-bottom: 20px;
        }

        .game-controls .btn {
            min-width: 150px;
            font-size: 1.2rem;
            padding: 15px 30px;
        }

        /* Game Result */
        .game-result {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .game-result.correct {
            background: linear-gradient(135deg, rgba(240, 255, 244, 0.9) 0%, rgba(198, 246, 213, 0.9) 100%);
            color: #2f855a;
            border: 2px solid #48bb78;
        }

        .game-result.incorrect {
            background: linear-gradient(135deg, rgba(254, 178, 178, 0.9) 0%, rgba(252, 129, 129, 0.9) 100%);
            color: #c53030;
            border: 2px solid #f56565;
        }

        /* Completion Screen */
        .completion-celebration {
            text-align: center;
            padding: 40px;
        }

        .celebration-animation {
            position: relative;
            margin-bottom: 30px;
        }

        .trophy {
            font-size: 6rem;
            animation: trophyBounce 2s ease-in-out infinite;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
        }

        @keyframes trophyBounce {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-20px) scale(1.1); }
        }

        .flowers {
            font-size: 2rem;
            margin: 20px 0;
            animation: flowersFloat 3s ease-in-out infinite;
        }

        @keyframes flowersFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .confetti {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .confetti-piece {
            position: absolute;
            font-size: 2rem;
            animation: confettiFall 3s ease-in-out infinite;
        }

        .confetti-piece:nth-child(1) { left: 10%; animation-delay: 0s; }
        .confetti-piece:nth-child(2) { left: 30%; animation-delay: 0.5s; }
        .confetti-piece:nth-child(3) { left: 50%; animation-delay: 1s; }
        .confetti-piece:nth-child(4) { left: 70%; animation-delay: 1.5s; }
        .confetti-piece:nth-child(5) { left: 90%; animation-delay: 2s; }

        @keyframes confettiFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(200px) rotate(360deg); opacity: 0; }
        }

        .completion-title {
            font-size: 2.5rem;
            color: #2d3748;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .completion-message {
            font-size: 1.3rem;
            color: #718096;
            margin-bottom: 30px;
        }

        .completion-btn {
            font-size: 1.3rem;
            padding: 15px 40px;
        }

        /* Responsive Design for Game */
        @media (max-width: 768px) {
            .game-packages {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .package-card {
                padding: 25px;
            }
            
            .start-game-btn {
                padding: 15px 30px;
                font-size: 1.2rem;
            }
            
            .game-header-play {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .question-card {
                padding: 25px;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .trophy {
                font-size: 4rem;
            }
            
            .completion-title {
                font-size: 2rem;
            }
        }

        /* About Container */
        .about-container {
            background: linear-gradient(135deg, rgba(210, 153, 194, 0.9) 0%, rgba(254, 249, 215, 0.9) 100%);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 40px;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .author-content {
            padding: 0;
        }

        .about-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.1);
        }

        .about-title h2 {
            color: #2d3748;
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .about-subtitle {
            color: #718096;
            font-size: 1.2rem;
            font-weight: 500;
            margin: 0;
        }

        .about-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .about-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
            text-align: center;
        }

        .about-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .card-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .card-content h3 {
            color: #2d3748;
            font-size: 1.4rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card-content h4 {
            color: #667eea;
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .card-content p {
            color: #718096;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .features-section {
            margin-bottom: 40px;
        }

        .features-section h3 {
            color: #2d3748;
            font-size: 1.8rem;
            margin-bottom: 25px;
            text-align: center;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .feature-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #4299e1;
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.2);
            background: rgba(255, 255, 255, 0.95);
        }

        .feature-icon {
            font-size: 2rem;
            min-width: 40px;
            text-align: center;
        }

        .feature-text {
            flex: 1;
        }

        .feature-text strong {
            display: block;
            color: #2d3748;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .feature-text span {
            color: #718096;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .technology-section {
            text-align: center;
        }

        .technology-section h3 {
            color: #2d3748;
            font-size: 1.8rem;
            margin-bottom: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .tech-tags {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }

        .tech-tag {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.3);
            transition: all 0.3s ease;
        }

        .tech-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(66, 153, 225, 0.4);
        }

        @media (max-width: 768px) {
            .beat-display {
                gap: 10px;
            }
            
            .beat {
                width: 60px;
                height: 60px;
                font-size: 1.2rem;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                margin: 5px 0;
            }

            .conducting-pattern svg {
                padding: 10px;
            }

            .tempo-info {
                flex-direction: column;
                text-align: center;
            }

            #conductingTempo {
                width: 150px;
            }

            .conducting-instructions ol {
                padding-left: 15px;
            }

            /* Theory responsive */
            .theory-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .beat-structure-grid.compact {
                grid-template-columns: repeat(2, 1fr);
            }

            .applications-grid.compact {
                grid-template-columns: repeat(2, 1fr);
            }

            .examples-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            /* About responsive */
            .about-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .tech-tags {
                gap: 10px;
            }

            .tech-tag {
                padding: 8px 16px;
                font-size: 0.8rem;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <div class="header">
    <h1 class="game-title">üéµ√ÇM NH·∫†C - NH·ªäP 4/4üéµ</h1>
    <p class="welcome-text">Ch√†o m·ª´ng c√°c em ƒë·∫øn v·ªõi ·ª©ng d·ª•ng h·ªçc √¢m nh·∫°c chuy√™n nghi·ªáp!</p>
   </div>
   <div class="tabs"><button class="tab active" onclick="showTab('simulator')">üéº M√¥ Ph·ªèng Nh·ªãp</button> <button class="tab" onclick="showTab('theory')">üìö L√Ω Thuy·∫øt</button> <button class="tab" onclick="showTab('quiz')">üéÆ Tr√≤ Ch∆°i</button> <button class="tab" onclick="showTab('ai-teacher')">ü§ñ AI Gi√°o Vi√™n</button> <button class="tab" onclick="showTab('about')">‚ÑπÔ∏è Gi·ªõi Thi·ªáu</button>
   </div><!-- Rhythm Simulator Tab -->
   <div id="simulator" class="tab-content active">
    <div class="rhythm-simulator">
     <h2 style="text-align: center; margin-bottom: 30px;">üéµ M√¥ Ph·ªèng Nh·ªãp 4/4</h2>
     <p style="text-align: center; font-size: 1.2rem; font-weight: 600; color: #4a5568; margin: 20px 0;"><strong>M√¥ ph·ªèng: M·∫°nh - Nh·∫π - M·∫°nh v·ª´a - Nh·∫π</strong></p>
     <div class="beat-display">
      <div class="beat strong" id="beat1">
       1<br><small>M·∫°nh</small>
      </div>
      <div class="beat weak" id="beat2">
       2<br><small>Nh·∫π</small>
      </div>
      <div class="beat medium" id="beat3">
       3<br><small>M·∫°nh v·ª´a</small>
      </div>
      <div class="beat weak" id="beat4">
       4<br><small>Nh·∫π</small>
      </div>
     </div>
     <div class="controls"><button class="btn btn-primary" onclick="startRhythm()">‚ñ∂Ô∏è B·∫Øt ƒê·∫ßu</button> <button class="btn btn-secondary" onclick="stopRhythm()">‚èπÔ∏è D·ª´ng</button>
     </div>
     <div class="tempo-control"><label>T·ªëc ƒë·ªô: </label> <input type="range" class="tempo-slider" min="60" max="140" value="100" id="tempoSlider" onchange="updateTempo()"> <span id="tempoDisplay">100 BPM</span>
     </div>
    </div>
   </div><!-- Theory Tab -->
   <div id="theory" class="tab-content">
    <div class="theory-container">
     <h2>üìö L√Ω Thuy·∫øt Nh·ªãp 4/4</h2><!-- Two Column Layout -->
     <div class="theory-layout"><!-- Left Column -->
      <div class="theory-left-column"><!-- Introduction Section -->
       <div class="theory-section compact">
        <div class="section-header">
         <h3>üéØ Gi·ªõi Thi·ªáu T·ªïng Quan</h3>
        </div>
        <div class="theory-content">
         <p><strong>Nh·ªãp 4/4</strong> c√≤n ƒë∆∞·ª£c g·ªçi l√† <em>nh·ªãp th√¥ng th∆∞·ªùng (common time)</em>, l√† m·ªôt trong nh·ªØng s·ªë ch·ªâ nh·ªãp ph·ªï bi·∫øn nh·∫•t trong √¢m nh·∫°c hi·ªán ƒë·∫°i.</p>
         <div class="highlight-box compact">
          <h4>üîë ƒê·∫∑c ƒëi·ªÉm ch√≠nh:</h4>
          <ul>
           <li>C√≥ <strong>b·ªën ph√°ch</strong> trong m·ªói √¥ nh·ªãp</li>
           <li>M·ªói ph√°ch t∆∞∆°ng ƒë∆∞∆°ng v·ªõi m·ªôt <strong>n·ªët ƒëen</strong></li>
           <li><strong>Ph√°ch 1</strong>: Ph√°ch m·∫°nh ch√≠nh</li>
           <li><strong>Ph√°ch 3</strong>: Ph√°ch m·∫°nh ph·ª•</li>
           <li>T·∫°o c·∫£m gi√°c <em>c√¢n b·∫±ng, ·ªïn ƒë·ªãnh v√† d·ªÖ theo</em></li>
          </ul>
         </div>
        </div>
       </div><!-- Beat Structure Section -->
       <div class="theory-section compact">
        <div class="section-header">
         <h3>üéº C·∫•u Tr√∫c Ph√°ch</h3>
        </div>
        <div class="theory-content">
         <div class="beat-structure-grid compact">
          <div class="beat-card strong-beat">
           <div class="beat-number">
            1
           </div>
           <div class="beat-type">
            M·∫†NH CH√çNH
           </div>
           <div class="beat-description">
            Ph√°ch quan tr·ªçng nh·∫•t
           </div>
          </div>
          <div class="beat-card weak-beat">
           <div class="beat-number">
            2
           </div>
           <div class="beat-type">
            NH·∫∏
           </div>
           <div class="beat-description">
            Ph√°ch y·∫øu, th∆∞ gi√£n
           </div>
          </div>
          <div class="beat-card medium-beat">
           <div class="beat-number">
            3
           </div>
           <div class="beat-type">
            M·∫†NH PH·ª§
           </div>
           <div class="beat-description">
            Ph√°ch m·∫°nh th·ª© hai
           </div>
          </div>
          <div class="beat-card weak-beat">
           <div class="beat-number">
            4
           </div>
           <div class="beat-type">
            NH·∫∏
           </div>
           <div class="beat-description">
            Chu·∫©n b·ªã √¥ nh·ªãp m·ªõi
           </div>
          </div>
         </div>
        </div>
       </div><!-- Applications Section -->
       <div class="theory-section compact">
        <div class="section-header">
         <h3>üéµ ·ª®ng D·ª•ng Trong √Çm Nh·∫°c</h3>
        </div>
        <div class="theory-content">
         <div class="applications-grid compact">
          <div class="genre-card">
           <div class="genre-icon">
            üé§
           </div>
           <div class="genre-name">
            Pop Music
           </div>
          </div>
          <div class="genre-card">
           <div class="genre-icon">
            üé∏
           </div>
           <div class="genre-name">
            Rock &amp; Metal
           </div>
          </div>
          <div class="genre-card">
           <div class="genre-icon">
            üé∫
           </div>
           <div class="genre-name">
            Jazz
           </div>
          </div>
          <div class="genre-card">
           <div class="genre-icon">
            üéª
           </div>
           <div class="genre-name">
            Classical
           </div>
          </div>
          <div class="genre-card">
           <div class="genre-icon">
            üéß
           </div>
           <div class="genre-name">
            Electronic
           </div>
          </div>
          <div class="genre-card">
           <div class="genre-icon">
            üé§
           </div>
           <div class="genre-name">
            Hip-Hop
           </div>
          </div>
         </div>
        </div>
       </div>
      </div><!-- Right Column -->
      <div class="theory-right-column"><!-- Conducting Diagram Section -->
       <div class="theory-section">
        <div class="section-header">
         <h3>üéº S∆° ƒê·ªì ƒê√°nh Nh·ªãp</h3>
        </div>
        <div class="theory-content">
         <div class="conducting-diagram">
          <div class="conducting-pattern">
           <svg width="100%" height="320" viewbox="0 0 400 320"><defs>
             <radialgradient id="bgGradient" cx="50%" cy="50%" r="50%">
              <stop offset="0%" style="stop-color:#f7fafc;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#e2e8f0;stop-opacity:1" />
             </radialgradient>
             <filter id="glow">
              <fegaussianblur stddeviation="3" result="coloredBlur" />
              <femerge>
               <femergenode in="coloredBlur" />
               <femergenode in="SourceGraphic" />
              </femerge>
             </filter>
             <lineargradient id="pathGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#4299e1;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#667eea;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
             </lineargradient>
            </defs> <rect width="100%" height="100%" fill="url(#bgGradient)" rx="15" /> <!-- Conducting pattern path --> <path id="conductingPath" d="M 200 80 L 200 200 L 120 150 L 280 150 L 200 80" fill="none" stroke="url(#pathGradient)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="0" opacity="0.8" /> <!-- Animated conductor hand --> <g id="conductorHand">
             <circle r="8" fill="#e53e3e" opacity="0.9" filter="url(#glow)">
              <animatemotion dur="4s" repeatcount="indefinite" rotate="auto">
               <mpath href="#conductingPath" />
              </animatemotion>
             </circle>
             <circle r="4" fill="#fff" opacity="0.8">
              <animatemotion dur="4s" repeatcount="indefinite" rotate="auto">
               <mpath href="#conductingPath" />
              </animatemotion>
             </circle>
            </g> <!-- Beat position indicators --> <g id="beatIndicators"><!-- Beat 1 - Strong -->
             <circle id="indicator1" cx="200" cy="80" r="12" fill="#e53e3e" opacity="0.6" filter="url(#glow)" />
             <circle cx="200" cy="80" r="8" fill="#fff" opacity="0.3" /> <!-- Beat 2 - Weak -->
             <circle id="indicator2" cx="200" cy="200" r="8" fill="#63b3ed" opacity="0.6" filter="url(#glow)" />
             <circle cx="200" cy="200" r="5" fill="#fff" opacity="0.3" /> <!-- Beat 3 - Medium -->
             <circle id="indicator3" cx="120" cy="150" r="10" fill="#f6ad55" opacity="0.6" filter="url(#glow)" />
             <circle cx="120" cy="150" r="6" fill="#fff" opacity="0.3" /> <!-- Beat 4 - Weak -->
             <circle id="indicator4" cx="280" cy="150" r="8" fill="#63b3ed" opacity="0.6" filter="url(#glow)" />
             <circle cx="280" cy="150" r="5" fill="#fff" opacity="0.3" />
            </g> <!-- Beat labels --> <g class="beat-labels">
             <text x="200" y="65" text-anchor="middle" class="beat-label-main">
              1
             </text>
             <text x="200" y="55" text-anchor="middle" class="beat-label-sub">
              M·∫†NH
             </text>
             <text x="200" y="225" text-anchor="middle" class="beat-label-main">
              2
             </text>
             <text x="200" y="235" text-anchor="middle" class="beat-label-sub">
              nh·∫π
             </text>
             <text x="120" y="135" text-anchor="middle" class="beat-label-main">
              3
             </text>
             <text x="120" y="125" text-anchor="middle" class="beat-label-sub">
              m·∫°nh v·ª´a
             </text>
             <text x="280" y="135" text-anchor="middle" class="beat-label-main">
              4
             </text>
             <text x="280" y="125" text-anchor="middle" class="beat-label-sub">
              nh·∫π
             </text>
            </g> <!-- Direction arrows --> <g class="direction-arrows" opacity="0.6">
             <path d="M 200 95 L 195 105 L 205 105 Z" fill="#4299e1" />
             <path d="M 200 185 L 195 175 L 205 175 Z" fill="#4299e1" />
             <path d="M 135 150 L 145 145 L 145 155 Z" fill="#4299e1" />
             <path d="M 265 150 L 255 145 L 255 155 Z" fill="#4299e1" />
            </g>
           </svg>
          </div>
          <div class="conducting-controls"><button class="btn btn-primary conducting-btn" onclick="toggleConducting()"> <span id="conductingBtnText">‚ñ∂Ô∏è B·∫Øt ƒê·∫ßu ƒê√°nh Nh·ªãp</span> </button>
           <div class="tempo-control-advanced">
            <div class="tempo-info"><label>T·ªëc ƒë·ªô:</label> <input type="range" id="conductingTempo" min="60" max="120" value="80" onchange="updateConductingTempo()"> <span id="conductingTempoDisplay">80 BPM</span>
            </div>
            <div class="tempo-presets"><button class="tempo-preset" onclick="setConductingTempo(60)">Ch·∫≠m</button> <button class="tempo-preset" onclick="setConductingTempo(80)">V·ª´a</button> <button class="tempo-preset" onclick="setConductingTempo(100)">Nhanh</button>
            </div>
           </div>
          </div>
          <div class="conducting-instructions">
           <h5>üìã H∆∞·ªõng d·∫´n ƒë√°nh nh·ªãp:</h5>
           <div class="instruction-grid">
            <div class="instruction-item">
             <div class="instruction-icon">
              1Ô∏è‚É£
             </div>
             <div class="instruction-content"><strong>Ph√°ch 1 - M·∫†NH NH·∫§T</strong><br>
               Tay xu·ªëng th·∫≥ng ‚¨áÔ∏è
             </div>
            </div>
            <div class="instruction-item">
             <div class="instruction-icon">
              2Ô∏è‚É£
             </div>
             <div class="instruction-content"><strong>Ph√°ch 2 - Nh·∫π</strong><br>
               Tay l√™n nh·∫π nh√†ng ‚¨ÜÔ∏è
             </div>
            </div>
            <div class="instruction-item">
             <div class="instruction-icon">
              3Ô∏è‚É£
             </div>
             <div class="instruction-content"><strong>Ph√°ch 3 - M·∫°nh v·ª´a</strong><br>
               Tay sang tr√°i ‚¨ÖÔ∏è
             </div>
            </div>
            <div class="instruction-item">
             <div class="instruction-icon">
              4Ô∏è‚É£
             </div>
             <div class="instruction-content"><strong>Ph√°ch 4 - Nh·∫π</strong><br>
               Tay sang ph·∫£i ‚û°Ô∏è
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div><!-- Examples Section - Full Width -->
     <div class="theory-section full-width">
      <div class="section-header">
       <h3>üé§ V√≠ D·ª• Th·ª±c T·∫ø &amp; M·∫πo H·ªçc T·∫≠p</h3>
      </div>
      <div class="theory-content">
       <div class="examples-layout">
        <div class="example-box">
         <h5>üéµ B√†i h√°t ph·ªï bi·∫øn v·ªõi nh·ªãp 4/4:</h5>
         <div class="song-examples">
          <div class="song-item"><span class="song-title">"Happy Birthday"</span> <span class="song-description">Sinh nh·∫≠t vui v·∫ª - B√†i h√°t quen thu·ªôc</span>
          </div>
          <div class="song-item"><span class="song-title">"Twinkle Twinkle Little Star"</span> <span class="song-description">Ng√¥i sao nh·ªè - B√†i h√°t thi·∫øu nhi</span>
          </div>
          <div class="song-item"><span class="song-title">H·∫ßu h·∫øt nh·∫°c Pop/Rock hi·ªán ƒë·∫°i</span> <span class="song-description">T·ª´ Taylor Swift ƒë·∫øn The Beatles</span>
          </div>
         </div>
        </div>
        <div class="tip-box">
         <h5>üí° M·∫πo h·ªçc t·∫≠p:</h5>
         <ul>
          <li>V·ªó tay theo nh·ªãp 1-2-3-4, nh·∫•n m·∫°nh ph√°ch 1, 3</li>
          <li>Nghe nh·∫°c v√† ƒë·∫øm nh·ªãp theo b√†i h√°t</li>
          <li>Th·ª±c h√†nh ƒë√°nh nh·ªãp v·ªõi tay theo s∆° ƒë·ªì</li>
          <li>B·∫Øt ƒë·∫ßu ch·∫≠m r·ªìi tƒÉng d·∫ßn t·ªëc ƒë·ªô</li>
         </ul>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Quiz Tab -->
   <div id="quiz" class="tab-content">
    <div class="quiz-container">
     <h2>üéÆ Tr√≤ Ch∆°i Nh·ªãp 4/4</h2>
     <div class="progress-bar">
      <div class="progress-fill" id="progressFill" style="width: 0%"></div>
     </div>
     <div class="score-display">
      ƒêi·ªÉm: <span id="score">0</span>/10
     </div>
     <div id="quizQuestions"></div>
     <div style="text-align: center; margin-top: 20px;"><button class="btn btn-primary" onclick="generateNewQuiz()">üîÑ T·∫°o B√†i M·ªõi</button> <button class="btn btn-secondary" onclick="resetQuiz()">‚Ü©Ô∏è L√†m L·∫°i</button>
     </div>
    </div>
   </div><!-- AI Teacher Tab -->
   <div id="ai-teacher" class="tab-content">
    <div class="ai-teacher">
     <h2>ü§ñ AI Gi√°o Vi√™n √Çm Nh·∫°c</h2>
     <div class="teacher-avatar">
      <svg class="ai-teacher-icon" viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><!-- AI Robot Head --> <rect x="25" y="20" width="50" height="45" rx="8" fill="#ffffff" opacity="0.9" /> <rect x="27" y="22" width="46" height="41" rx="6" fill="#e2e8f0" /> <!-- AI Eyes --> <circle cx="35" cy="35" r="4" fill="#4299e1" /> <circle cx="65" cy="35" r="4" fill="#4299e1" /> <circle cx="35" cy="35" r="2" fill="#ffffff" /> <circle cx="65" cy="35" r="2" fill="#ffffff" /> <!-- AI Mouth/Speaker --> <rect x="40" y="45" width="20" height="8" rx="4" fill="#4299e1" /> <rect x="42" y="47" width="16" height="4" rx="2" fill="#ffffff" /> <!-- AI Antenna --> <line x1="50" y1="20" x2="50" y2="10" stroke="#4299e1" stroke-width="2" /> <circle cx="50" cy="8" r="3" fill="#f6ad55" /> <!-- Musical Note in Hand --> <g transform="translate(70, 50)"><!-- Note stem -->
        <line x1="8" y1="15" x2="8" y2="5" stroke="#2d3748" stroke-width="2" /> <!-- Note head -->
        <ellipse cx="5" cy="15" rx="3" ry="2" fill="#2d3748" /> <!-- Note flag -->
        <path d="M 8 5 Q 15 8 12 12 Q 10 10 8 8" fill="#2d3748" />
       </g> <!-- AI Hand holding note --> <circle cx="78" cy="60" r="8" fill="#ffffff" opacity="0.9" /> <circle cx="78" cy="60" r="6" fill="#e2e8f0" /> <!-- AI Body --> <rect x="35" y="65" width="30" height="25" rx="4" fill="#ffffff" opacity="0.9" /> <rect x="37" y="67" width="26" height="21" rx="3" fill="#e2e8f0" /> <!-- Control Panel --> <circle cx="45" cy="75" r="2" fill="#48bb78" /> <circle cx="55" cy="75" r="2" fill="#f56565" /> <rect x="42" y="82" width="16" height="3" rx="1" fill="#4299e1" /> <!-- Musical notes floating around --> <text x="15" y="15" font-size="8" fill="#4299e1" opacity="0.7">
        ‚ô™
       </text> <text x="85" y="25" font-size="6" fill="#f6ad55" opacity="0.7">
        ‚ô´
       </text> <text x="20" y="80" font-size="7" fill="#48bb78" opacity="0.7">
        ‚ô™
       </text> <text x="80" y="85" font-size="8" fill="#9f7aea" opacity="0.7">
        ‚ô´
       </text>
      </svg>
     </div>
     <p style="text-align: center; font-size: 1.2rem; font-weight: bold;">AI √Çm Nh·∫°c</p>
     <p style="text-align: center;">H√£y h·ªèi AI v·ªÅ nh·ªãp 4/4 nh√©!</p>
     <div class="chat-container" id="chatContainer">
      <div class="message ai"><strong>AI √Çm Nh·∫°c:</strong> Ch√†o em! AI s·∫µn s√†ng tr·∫£ l·ªùi m·ªçi c√¢u h·ªèi v·ªÅ nh·ªãp 4/4. H√£y h·ªèi AI b·∫•t c·ª© ƒëi·ªÅu g√¨ em mu·ªën bi·∫øt nh√©! üéµ
      </div>
     </div>
     <div class="input-container"><input type="text" class="question-input" id="questionInput" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa em v·ªÅ nh·ªãp 4/4..." onkeypress="handleEnter(event)"> <button class="btn btn-primary" onclick="askAI()">H·ªèi</button>
     </div>
    </div>
   </div><!-- About Tab -->
   <div id="about" class="tab-content">
    <div class="about-container">
     <div class="author-content">
      <div class="about-header">
       <div class="about-title">
        <h2>‚ÑπÔ∏è Gi·ªõi Thi·ªáu ·ª®ng D·ª•ng</h2>
        <p class="about-subtitle">·ª®ng d·ª•ng h·ªçc √¢m nh·∫°c chuy√™n nghi·ªáp d√†nh cho m·ªçi l·ª©a tu·ªïi</p>
       </div>
      </div>
      <div class="about-grid">
       <div class="about-card">
        <div class="card-icon">
         üë®‚Äçüíª
        </div>
        <div class="card-content">
         <h3>T√°c Gi·∫£</h3>
         <h4>Tu·∫•n Anh</h4>
         <p>Chuy√™n gia ph√°t tri·ªÉn ·ª©ng d·ª•ng gi√°o d·ª•c v·ªõi nhi·ªÅu nƒÉm kinh nghi·ªám trong lƒ©nh v·ª±c c√¥ng ngh·ªá √¢m nh·∫°c</p>
        </div>
       </div>
       <div class="about-card">
        <div class="card-icon">
         üéØ
        </div>
        <div class="card-content">
         <h3>M·ª•c Ti√™u</h3>
         <p>T·∫°o ra c√¥ng c·ª• h·ªçc t·∫≠p √¢m nh·∫°c hi·ªáu qu·∫£, d·ªÖ s·ª≠ d·ª•ng v√† ph√π h·ª£p v·ªõi ng∆∞·ªùi Vi·ªát Nam, gi√∫p m·ªçi ng∆∞·ªùi ti·∫øp c·∫≠n √¢m nh·∫°c m·ªôt c√°ch khoa h·ªçc</p>
        </div>
       </div>
       <div class="about-card">
        <div class="card-icon">
         üåü
        </div>
        <div class="card-content">
         <h3>T·∫ßm Nh√¨n</h3>
         <p>Ph·ªï c·∫≠p ki·∫øn th·ª©c √¢m nh·∫°c c∆° b·∫£n, gi√∫p h·ªçc vi√™n x√¢y d·ª±ng n·ªÅn t·∫£ng v·ªØng ch·∫Øc trong vi·ªác h·ªçc v√† th∆∞·ªüng th·ª©c √¢m nh·∫°c</p>
        </div>
       </div>
      </div>
      <div class="features-section">
       <h3>‚ú® T√≠nh NƒÉng N·ªïi B·∫≠t</h3>
       <div class="features-grid">
        <div class="feature-item">
         <div class="feature-icon">
          üéµ
         </div>
         <div class="feature-text"><strong>M√¥ Ph·ªèng Nh·ªãp Th·ª±c T·∫ø</strong> <span>√Çm thanh ch√¢n th·ª±c v·ªõi c√°c m·ª©c ƒë·ªô m·∫°nh y·∫øu kh√°c nhau</span>
         </div>
        </div>
        <div class="feature-item">
         <div class="feature-icon">
          üéº
         </div>
         <div class="feature-text"><strong>S∆° ƒê·ªì ƒê√°nh Nh·ªãp T∆∞∆°ng T√°c</strong> <span>H√¨nh ·∫£nh ƒë·ªông tr·ª±c quan, d·ªÖ hi·ªÉu v√† theo d√µi</span>
         </div>
        </div>
        <div class="feature-item">
         <div class="feature-icon">
          üìù
         </div>
         <div class="feature-text"><strong>H·ªá Th·ªëng Tr·∫Øc Nghi·ªám</strong> <span>ƒê√°nh gi√° ki·∫øn th·ª©c v·ªõi c√¢u h·ªèi ƒëa d·∫°ng v√† ph·∫£n h·ªìi t·ª©c th√¨</span>
         </div>
        </div>
        <div class="feature-item">
         <div class="feature-icon">
          ü§ñ
         </div>
         <div class="feature-text"><strong>AI Gi√°o Vi√™n Th√¥ng Minh</strong> <span>Tr·∫£ l·ªùi c√¢u h·ªèi v√† h∆∞·ªõng d·∫´n h·ªçc t·∫≠p 24/7</span>
         </div>
        </div>
        <div class="feature-item">
         <div class="feature-icon">
          üì±
         </div>
         <div class="feature-text"><strong>Giao Di·ªán Th√¢n Thi·ªán</strong> <span>Thi·∫øt k·∫ø responsive, ho·∫°t ƒë·ªông m∆∞·ª£t m√† tr√™n m·ªçi thi·∫øt b·ªã</span>
         </div>
        </div>
        <div class="feature-item">
         <div class="feature-icon">
          üéØ
         </div>
         <div class="feature-text"><strong>Ph√π H·ª£p M·ªçi L·ª©a Tu·ªïi</strong> <span>T·ª´ tr·∫ª em ƒë·∫øn ng∆∞·ªùi l·ªõn ƒë·ªÅu c√≥ th·ªÉ h·ªçc t·∫≠p hi·ªáu qu·∫£</span>
         </div>
        </div>
       </div>
      </div>
      <div class="technology-section">
       <h3>‚ö° C√¥ng Ngh·ªá S·ª≠ D·ª•ng</h3>
       <div class="tech-tags"><span class="tech-tag">HTML5</span> <span class="tech-tag">CSS3</span> <span class="tech-tag">JavaScript</span> <span class="tech-tag">Web Audio API</span> <span class="tech-tag">SVG Animation</span> <span class="tech-tag">Responsive Design</span>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Configuration object
        const defaultConfig = {
            game_title: "üéµ√ÇM NH·∫†C - NH·ªäP 4/4üéµ",
            welcome_message: "Ch√†o m·ª´ng c√°c em ƒë·∫øn v·ªõi ·ª©ng d·ª•ng h·ªçc √¢m nh·∫°c chuy√™n nghi·ªáp!",
            ai_teacher_name: "AI √Çm Nh·∫°c"
        };

        // Rhythm simulator variables
        let rhythmInterval;
        let currentBeat = 0;
        let isPlaying = false;
        let tempo = 100;

        // Audio system for rhythm beats
        let audioContext;
        let isAudioEnabled = true;

        // Initialize audio context
        function initAudioContext() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.log('Web Audio API not supported');
                isAudioEnabled = false;
            }
        }

        // Create beat sound with different frequencies for different beat strengths
        function playBeatSound(beatType) {
            if (!isAudioEnabled || !audioContext) return;

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Different frequencies and volumes for different beat types
            switch(beatType) {
                case 'strong': // Beat 1 - Strongest
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    break;
                case 'medium': // Beat 3 - Medium strong
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    break;
                case 'weak': // Beat 2, 4 - Weak
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                    break;
            }
            
            oscillator.type = 'sine';
            
            // Create envelope for natural sound
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }

        // Conducting diagram variables
        let conductingTempo = 80;
        let isConducting = false;
        let conductingAnimation;

        // Quiz variables
        let currentQuiz = [];
        let userAnswers = [];
        let quizScore = 0;
        let currentQuestionIndex = 0;

        // Game variables
        let gameState = {
            currentPackage: '',
            currentQuestionIndex: 0,
            lives: 3,
            selectedAnswer: -1,
            completedPackages: [],
            currentQuestions: []
        };

        // Game questions database
        const gameQuestions = {
            easy: [
                {
                    type: 'multiple_choice',
                    question: 'Nh·ªãp 4/4 c√≥ bao nhi√™u ph√°ch trong m·ªôt √¥ nh·ªãp?',
                    options: ['2 ph√°ch', '3 ph√°ch', '4 ph√°ch', '5 ph√°ch'],
                    correct: 2
                },
                {
                    type: 'true_false',
                    question: 'Nh·ªãp 4/4 c√≤n ƒë∆∞·ª£c g·ªçi l√† "nh·ªãp th√¥ng th∆∞·ªùng"',
                    options: ['ƒê√∫ng', 'Sai'],
                    correct: 0
                },
                {
                    type: 'fill_blank',
                    question: 'Trong nh·ªãp 4/4, m·ªói ph√°ch t∆∞∆°ng ƒë∆∞∆°ng v·ªõi m·ªôt n·ªët ____',
                    options: ['tr·∫Øng', 'ƒëen', 'm√≥c ƒë∆°n', 'tr√≤n'],
                    correct: 1
                },
                {
                    type: 'multiple_choice',
                    question: 'Ph√°ch n√†o trong nh·ªãp 4/4 l√† ph√°ch m·∫°nh ch√≠nh?',
                    options: ['Ph√°ch 1', 'Ph√°ch 2', 'Ph√°ch 3', 'Ph√°ch 4'],
                    correct: 0
                },
                {
                    type: 'matching',
                    question: 'Gh√©p ƒë√¥i ph√°ch v·ªõi c∆∞·ªùng ƒë·ªô t∆∞∆°ng ·ª©ng:',
                    pairs: [
                        { left: 'Ph√°ch 1', right: 'M·∫°nh ch√≠nh' },
                        { left: 'Ph√°ch 2', right: 'Nh·∫π' },
                        { left: 'Ph√°ch 3', right: 'M·∫°nh ph·ª•' },
                        { left: 'Ph√°ch 4', right: 'Nh·∫π' }
                    ],
                    correct: [0, 1, 2, 3]
                }
            ],
            medium: [
                {
                    type: 'multiple_choice',
                    question: 'Th·ª© t·ª± c∆∞·ªùng ƒë·ªô c√°c ph√°ch trong nh·ªãp 4/4 l√† g√¨?',
                    options: ['M·∫°nh - M·∫°nh - Nh·∫π - Nh·∫π', 'M·∫°nh - Nh·∫π - M·∫°nh v·ª´a - Nh·∫π', 'Nh·∫π - M·∫°nh - Nh·∫π - M·∫°nh', 'T·∫•t c·∫£ ƒë·ªÅu m·∫°nh nh∆∞ nhau'],
                    correct: 1
                },
                {
                    type: 'true_false',
                    question: 'Nh·ªãp 4/4 ch·ªâ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong nh·∫°c pop v√† rock',
                    options: ['ƒê√∫ng', 'Sai'],
                    correct: 1
                },
                {
                    type: 'fill_blank',
                    question: 'B√†i h√°t "Happy Birthday" s·ª≠ d·ª•ng nh·ªãp ____',
                    options: ['3/4', '4/4', '2/4', '6/8'],
                    correct: 1
                },
                {
                    type: 'multiple_choice',
                    question: 'Khi ƒë√°nh nh·ªãp 4/4, tay di chuy·ªÉn theo h∆∞·ªõng n√†o?',
                    options: ['Xu·ªëng - Tr√°i - Ph·∫£i - L√™n', 'Xu·ªëng - Ph·∫£i - Tr√°i - L√™n', 'L√™n - Xu·ªëng - Tr√°i - Ph·∫£i', 'Tr√°i - Ph·∫£i - Xu·ªëng - L√™n'],
                    correct: 0
                },
                {
                    type: 'matching',
                    question: 'Gh√©p ƒë√¥i th·ªÉ lo·∫°i nh·∫°c v·ªõi vi·ªác s·ª≠ d·ª•ng nh·ªãp 4/4:',
                    pairs: [
                        { left: 'Pop Music', right: 'C√≥ s·ª≠ d·ª•ng' },
                        { left: 'Jazz', right: 'C√≥ s·ª≠ d·ª•ng' },
                        { left: 'Classical', right: 'C√≥ s·ª≠ d·ª•ng' },
                        { left: 'Hip-Hop', right: 'C√≥ s·ª≠ d·ª•ng' }
                    ],
                    correct: [0, 1, 2, 3]
                }
            ],
            hard: [
                {
                    type: 'multiple_choice',
                    question: 'Trong c√¢u "Khi hai ta v·ªÅ m·ªôt nh√†", t·ª´ "Khi" r∆°i v√†o ph√°ch n√†o?',
                    options: ['Ph√°ch 1', 'Ph√°ch 2', 'Ph√°ch 3', 'Ph√°ch 4'],
                    correct: 0
                },
                {
                    type: 'true_false',
                    question: 'Nh·ªãp 4/4 t·∫°o c·∫£m gi√°c b·∫•t ·ªïn v√† kh√≥ theo',
                    options: ['ƒê√∫ng', 'Sai'],
                    correct: 1
                },
                {
                    type: 'fill_blank',
                    question: 'Trong d√†n nh·∫°c, nh·∫°c tr∆∞·ªüng th∆∞·ªùng ƒë√°nh nh·ªãp theo h√¨nh ____ cho nh·ªãp 4/4',
                    options: ['tam gi√°c', 'vu√¥ng', 'tr√≤n', 'ch·ªØ T ng∆∞·ª£c'],
                    correct: 3
                },
                {
                    type: 'multiple_choice',
                    question: 'T·∫°i sao nh·ªãp 4/4 ƒë∆∞·ª£c g·ªçi l√† "common time"?',
                    options: ['V√¨ n√≥ kh√≥ h·ªçc', 'V√¨ n√≥ r·∫•t ph·ªï bi·∫øn v√† th√¥ng th∆∞·ªùng', 'V√¨ n√≥ ch·ªâ d√†nh cho ng∆∞·ªùi m·ªõi h·ªçc', 'V√¨ n√≥ ƒë∆∞·ª£c ph√°t minh g·∫ßn ƒë√¢y'],
                    correct: 1
                },
                {
                    type: 'matching',
                    question: 'Gh√©p ƒë√¥i ƒë·∫∑c ƒëi·ªÉm v·ªõi nh·ªãp 4/4:',
                    pairs: [
                        { left: 'C·∫£m gi√°c', right: 'C√¢n b·∫±ng, ·ªïn ƒë·ªãnh' },
                        { left: 'K√Ω hi·ªáu', right: 'C ho·∫∑c 4/4' },
                        { left: 'Ph√°ch m·∫°nh', right: 'Ph√°ch 1 v√† 3' },
                        { left: '·ª®ng d·ª•ng', right: 'ƒêa d·∫°ng th·ªÉ lo·∫°i' }
                    ],
                    correct: [0, 1, 2, 3]
                }
            ]
        };

        // Quiz questions database
        const quizDatabase = [
            {
                question: "Nh·ªãp 4/4 c√≥ bao nhi√™u ph√°ch trong m·ªôt √¥ nh·ªãp?",
                options: ["2 ph√°ch", "3 ph√°ch", "4 ph√°ch", "5 ph√°ch"],
                correct: 2
            },
            {
                question: "Nh·ªãp 4/4 c√≤n ƒë∆∞·ª£c g·ªçi l√† g√¨?",
                options: ["Nh·ªãp ƒë·∫∑c bi·ªát", "Nh·ªãp th√¥ng th∆∞·ªùng (common time)", "Nh·ªãp nhanh", "Nh·ªãp ch·∫≠m"],
                correct: 1
            },
            {
                question: "Trong nh·ªãp 4/4, m·ªói ph√°ch t∆∞∆°ng ƒë∆∞∆°ng v·ªõi n·ªët g√¨?",
                options: ["N·ªët tr·∫Øng", "N·ªët ƒëen", "N·ªët m√≥c ƒë∆°n", "N·ªët tr√≤n"],
                correct: 1
            },
            {
                question: "Ph√°ch n√†o trong nh·ªãp 4/4 l√† ph√°ch m·∫°nh ch√≠nh?",
                options: ["Ph√°ch 1", "Ph√°ch 2", "Ph√°ch 3", "Ph√°ch 4"],
                correct: 0
            },
            {
                question: "Ph√°ch n√†o trong nh·ªãp 4/4 l√† ph√°ch m·∫°nh ph·ª•?",
                options: ["Ph√°ch 1", "Ph√°ch 2", "Ph√°ch 3", "Ph√°ch 4"],
                correct: 2
            },
            {
                question: "Nh·ªãp 4/4 ƒë∆∞·ª£c s·ª≠ d·ª•ng trong th·ªÉ lo·∫°i nh·∫°c n√†o?",
                options: ["Ch·ªâ nh·∫°c pop", "Ch·ªâ nh·∫°c c·ªï ƒëi·ªÉn", "Pop, rock, jazz, c·ªï ƒëi·ªÉn, hip-hop", "Ch·ªâ nh·∫°c d√¢n gian"],
                correct: 2
            },
            {
                question: "B√†i h√°t 'Khi hai ta v·ªÅ m·ªôt nh√†' c·ªßa Ti√™n Ti√™n s·ª≠ d·ª•ng nh·ªãp g√¨?",
                options: ["Nh·ªãp 3/4", "Nh·ªãp 4/4", "Nh·ªãp 2/4", "Nh·ªãp 6/8"],
                correct: 1
            },
            {
                question: "Trong c√¢u 'Khi hai ta v·ªÅ m·ªôt nh√†', t·ª´ 'Khi' r∆°i v√†o ph√°ch n√†o?",
                options: ["Ph√°ch 1", "Ph√°ch 2", "Ph√°ch 3", "Ph√°ch 4"],
                correct: 0
            },
            {
                question: "Nh·ªãp 4/4 t·∫°o c·∫£m gi√°c nh∆∞ th·∫ø n√†o?",
                options: ["B·∫•t ·ªïn v√† kh√≥ theo", "C√¢n b·∫±ng, ·ªïn ƒë·ªãnh v√† d·ªÖ theo", "Ch·ªâ ph√π h·ª£p v·ªõi nh·∫°c bu·ªìn", "Qu√° ph·ª©c t·∫°p"],
                correct: 1
            },
            {
                question: "Th·ª© t·ª± c∆∞·ªùng ƒë·ªô c√°c ph√°ch trong nh·ªãp 4/4 l√† g√¨?",
                options: ["M·∫°nh - M·∫°nh - Nh·∫π - Nh·∫π", "M·∫°nh - Nh·∫π - M·∫°nh v·ª´a - Nh·∫π", "Nh·∫π - M·∫°nh - Nh·∫π - M·∫°nh", "T·∫•t c·∫£ ƒë·ªÅu m·∫°nh nh∆∞ nhau"],
                correct: 1
            }
        ];

        // AI responses database
        const aiResponses = {
            "nh·ªãp 4/4 l√† g√¨": "Nh·ªãp 4/4 c√≤n ƒë∆∞·ª£c g·ªçi l√† 'nh·ªãp th√¥ng th∆∞·ªùng' (common time) ƒë·∫•y em! N√≥ c√≥ 4 ph√°ch trong m·ªói √¥ nh·ªãp, v√† m·ªói ph√°ch b·∫±ng m·ªôt n·ªët ƒëen. Gi·ªëng nh∆∞ em ƒë·∫øm 1-2-3-4 r·ªìi l·∫°i b·∫Øt ƒë·∫ßu t·ª´ 1! ƒê√¢y l√† nh·ªãp ph·ªï bi·∫øn nh·∫•t trong √¢m nh·∫°c hi·ªán ƒë·∫°i! üì¶üéµ",
            
            "common time": "Common time ch√≠nh l√† t√™n ti·∫øng Anh c·ªßa nh·ªãp 4/4! N√≥ ƒë∆∞·ª£c g·ªçi nh∆∞ v·∫≠y v√¨ r·∫•t ph·ªï bi·∫øn v√† 'th√¥ng th∆∞·ªùng' trong h·∫ßu h·∫øt c√°c b√†i h√°t. T·ª´ nh·∫°c pop, rock, jazz ƒë·∫øn c·ªï ƒëi·ªÉn ƒë·ªÅu d√πng nh·ªãp n√†y! üåçüéº",
            
            "ph√°ch m·∫°nh ph·ª•": "Trong nh·ªãp 4/4, ph√°ch 3 l√† ph√°ch m·∫°nh ph·ª•! N√≥ kh√¥ng m·∫°nh b·∫±ng ph√°ch 1 nh∆∞ng m·∫°nh h∆°n ph√°ch 2 v√† 4. Gi·ªëng nh∆∞ khi em ƒëi b·ªô: b∆∞·ªõc tr√°i m·∫°nh (1), b∆∞·ªõc ph·∫£i nh·∫π (2), b∆∞·ªõc tr√°i v·ª´a (3), b∆∞·ªõc ph·∫£i nh·∫π (4)! üë£‚ú®",
            
            "khi hai ta v·ªÅ m·ªôt nh√†": "ƒê√≥ l√† v√≠ d·ª• tuy·ªát v·ªùi v·ªÅ nh·ªãp 4/4! 'Khi (1) ‚Äì hai ‚Äì ta (2) ‚Äì v·ªÅ ‚Äì m·ªôt (3) ‚Äì nh√† (4)'. Ph√°ch 1 v√† 3 ƒë∆∞·ª£c nh·∫•n m·∫°nh, t·∫°o c·∫£m gi√°c c√¢n b·∫±ng v√† l√£ng m·∫°n. Th·ª≠ h√°t v√† ƒë·∫øm nh·ªãp xem em! üéµüíï",
            
            "n·ªët ƒëen": "Trong nh·ªãp 4/4, m·ªói ph√°ch t∆∞∆°ng ƒë∆∞∆°ng v·ªõi m·ªôt n·ªët ƒëen! N·ªët ƒëen l√† ƒë∆°n v·ªã th·ªùi gian c∆° b·∫£n, kh√¥ng qu√° nhanh kh√¥ng qu√° ch·∫≠m. Gi·ªëng nh∆∞ nh·ªãp tim b√¨nh th∆∞·ªùng c·ªßa em v·∫≠y! ‚ô©üíì",
            
            "t·∫°i sao nh·ªãp 4/4 ph·ªï bi·∫øn": "V√¨ nh·ªãp 4/4 t·∫°o c·∫£m gi√°c c√¢n b·∫±ng, ·ªïn ƒë·ªãnh v√† d·ªÖ theo! N√≥ gi·ªëng nh·ªãp t·ª± nhi√™n c·ªßa c∆° th·ªÉ: ƒëi b·ªô, nh·ªãp tim, th·ªü... T·ª´ nh·∫°c pop, rock, jazz, c·ªï ƒëi·ªÉn, hip-hop ƒë·ªÅu d√πng nh·ªãp n√†y v√¨ d·ªÖ nghe v√† d·ªÖ nh·ªõ! üèÉ‚Äç‚ôÄÔ∏è‚ù§Ô∏èüé∂",
            
            "c√°ch ƒë√°nh nh·ªãp 4/4": "Em h√£y t∆∞·ªüng t∆∞·ª£ng v·∫Ω m·ªôt h√¨nh vu√¥ng trong kh√¥ng kh√≠! Ph√°ch 1: tay xu·ªëng (m·∫°nh), ph√°ch 2: sang tr√°i (nh·∫π), ph√°ch 3: sang ph·∫£i (m·∫°nh v·ª´a), ph√°ch 4: l√™n tr√™n (nh·∫π). Ph√°ch 1 v√† 3 nh·∫•n m·∫°nh h∆°n nh√©! ‚¨áÔ∏è‚¨ÖÔ∏è‚û°Ô∏è‚¨ÜÔ∏è",
            
            "v√≠ d·ª• v·ªÅ nh·ªãp 4/4": "R·∫•t nhi·ªÅu b√†i h√°t em bi·∫øt ƒë·ªÅu l√† nh·ªãp 4/4! Nh∆∞ 'Khi hai ta v·ªÅ m·ªôt nh√†' c·ªßa Ti√™n Ti√™n, 'Happy Birthday', 'Twinkle Twinkle Little Star'. H·∫ßu h·∫øt nh·∫°c pop v√† rock ƒë·ªÅu d√πng nh·ªãp n√†y! Th·ª≠ ƒë·∫øm 1-2-3-4 theo nh·ªØng b√†i n√†y xem! ‚≠êüéÇüéà"
        };

        // Initialize the app
        function init() {
            generateNewQuiz();
            updateDisplay();
        }

        // Element SDK implementation
        async function render(config) {
            document.querySelector('.game-title').textContent = config.game_title || defaultConfig.game_title;
            document.querySelector('.welcome-text').textContent = config.welcome_message || defaultConfig.welcome_message;
            
            // Update AI teacher name
            const teacherNameElements = document.querySelectorAll('.ai-teacher p');
            if (teacherNameElements.length > 1) {
                teacherNameElements[1].textContent = config.ai_teacher_name || defaultConfig.ai_teacher_name;
            }
            
            // Update chat messages
            const aiMessages = document.querySelectorAll('.message.ai strong');
            aiMessages.forEach(msg => {
                msg.textContent = `${config.ai_teacher_name || defaultConfig.ai_teacher_name}:`;
            });
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["game_title", config.game_title || defaultConfig.game_title],
                ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
                ["ai_teacher_name", config.ai_teacher_name || defaultConfig.ai_teacher_name]
            ]);
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                render,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        function updateDisplay() {
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            render(config);
        }

        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Rhythm simulator functions
        function startRhythm() {
            if (isPlaying) return;
            
            // Initialize audio context on first user interaction
            if (!audioContext) {
                initAudioContext();
            }
            
            isPlaying = true;
            currentBeat = 0;
            
            const beatInterval = 60000 / tempo; // Convert BPM to milliseconds
            
            rhythmInterval = setInterval(() => {
                // Reset all beats
                document.querySelectorAll('.beat').forEach(beat => {
                    beat.classList.remove('active');
                });
                
                // Activate current beat
                const currentBeatElement = document.getElementById(`beat${currentBeat + 1}`);
                currentBeatElement.classList.add('active');
                
                // Play appropriate sound for each beat
                let beatType;
                switch(currentBeat) {
                    case 0: // Beat 1 - Strong
                        beatType = 'strong';
                        break;
                    case 2: // Beat 3 - Medium
                        beatType = 'medium';
                        break;
                    case 1: // Beat 2 - Weak
                    case 3: // Beat 4 - Weak
                        beatType = 'weak';
                        break;
                }
                playBeatSound(beatType);
                
                // Move to next beat
                currentBeat = (currentBeat + 1) % 4;
            }, beatInterval);
        }

        function stopRhythm() {
            isPlaying = false;
            clearInterval(rhythmInterval);
            
            // Reset all beats
            document.querySelectorAll('.beat').forEach(beat => {
                beat.classList.remove('active');
            });
            
            currentBeat = 0;
        }

        function updateTempo() {
            tempo = document.getElementById('tempoSlider').value;
            document.getElementById('tempoDisplay').textContent = tempo + ' BPM';
            
            // If playing, restart with new tempo
            if (isPlaying) {
                stopRhythm();
                startRhythm();
            }
        }

        // Quiz functions
        function generateNewQuiz() {
            // Use all 10 questions
            const shuffled = [...quizDatabase].sort(() => Math.random() - 0.5);
            currentQuiz = shuffled;
            userAnswers = new Array(10).fill(-1);
            quizScore = 0;
            currentQuestionIndex = 0;
            
            renderCurrentQuestion();
            updateQuizProgress();
        }

        function renderCurrentQuestion() {
            const container = document.getElementById('quizQuestions');
            container.innerHTML = '';
            
            if (currentQuestionIndex >= currentQuiz.length) {
                showQuizResults();
                return;
            }
            
            const q = currentQuiz[currentQuestionIndex];
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question';
            questionDiv.innerHTML = `
                <h3>C√¢u ${currentQuestionIndex + 1}/10: ${q.question}</h3>
                <div class="options">
                    ${q.options.map((option, optIndex) => `
                        <div class="option" onclick="selectAnswer(${optIndex})">
                            ${String.fromCharCode(65 + optIndex)}. ${option}
                        </div>
                    `).join('')}
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    ${currentQuestionIndex > 0 ? '<button class="btn btn-secondary" onclick="previousQuestion()">‚¨ÖÔ∏è C√¢u Tr∆∞·ªõc</button>' : ''}
                </div>
            `;
            container.appendChild(questionDiv);
        }

        function showQuizResults() {
            const container = document.getElementById('quizQuestions');
            const percentage = Math.round((quizScore / 10) * 100);
            let message = '';
            
            if (percentage >= 80) {
                message = 'üéâ Xu·∫•t s·∫Øc! Em ƒë√£ hi·ªÉu r·∫•t r√µ v·ªÅ nh·ªãp 4/4!';
            } else if (percentage >= 60) {
                message = 'üëç T·ªët l·∫Øm! Em c·∫ßn √¥n t·∫≠p th√™m m·ªôt ch√∫t n·ªØa!';
            } else {
                message = 'üí™ C·ªë g·∫Øng l√™n! H√£y xem l·∫°i ph·∫ßn m√¥ ph·ªèng nh·ªãp v√† th·ª≠ l·∫°i!';
            }
            
            container.innerHTML = `
                <div class="question" style="text-align: center;">
                    <h2>üèÜ K·∫øt Qu·∫£ B√†i Thi</h2>
                    <div style="font-size: 3rem; margin: 20px 0;">${percentage}%</div>
                    <div style="font-size: 1.5rem; margin: 20px 0;">ƒêi·ªÉm: ${quizScore}/10</div>
                    <p style="font-size: 1.2rem; color: #4a5568;">${message}</p>
                </div>
            `;
        }

        function selectAnswer(optionIndex) {
            userAnswers[currentQuestionIndex] = optionIndex;
            
            // Update UI
            const questionDiv = document.querySelector('.question');
            const options = questionDiv.querySelectorAll('.option');
            
            // Reset all options
            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                opt.style.pointerEvents = 'none';
            });
            
            // Mark selected option
            options[optionIndex].classList.add('selected');
            
            // Show correct answer
            const correctIndex = currentQuiz[currentQuestionIndex].correct;
            options[correctIndex].classList.add('correct');
            
            if (optionIndex !== correctIndex) {
                options[optionIndex].classList.add('incorrect');
            } else {
                quizScore++;
            }
            
            updateQuizProgress();
            
            // Auto advance to next question after 2 seconds
            setTimeout(() => {
                nextQuestion();
            }, 2000);
        }

        function nextQuestion() {
            currentQuestionIndex++;
            renderCurrentQuestion();
            updateQuizProgress();
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                // Subtract score if going back and answer was correct
                if (userAnswers[currentQuestionIndex] === currentQuiz[currentQuestionIndex].correct) {
                    quizScore--;
                }
                currentQuestionIndex--;
                renderCurrentQuestion();
                updateQuizProgress();
            }
        }

        function updateQuizProgress() {
            const progress = ((currentQuestionIndex + 1) / 10) * 100;
            
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('score').textContent = quizScore;
        }

        function resetQuiz() {
            userAnswers = new Array(10).fill(-1);
            quizScore = 0;
            currentQuestionIndex = 0;
            renderCurrentQuestion();
            updateQuizProgress();
        }

        // AI Teacher functions
        function askAI() {
            const input = document.getElementById('questionInput');
            const question = input.value.trim().toLowerCase();
            
            if (!question) return;
            
            // Add user message
            addMessage('user', input.value);
            
            // Generate AI response
            const response = generateAIResponse(question);
            
            setTimeout(() => {
                addMessage('ai', response);
            }, 1000);
            
            input.value = '';
        }

        function handleEnter(event) {
            if (event.key === 'Enter') {
                askAI();
            }
        }

        function addMessage(sender, text) {
            const container = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const teacherName = config.ai_teacher_name || defaultConfig.ai_teacher_name;
            
            if (sender === 'user') {
                messageDiv.innerHTML = `<strong>Em:</strong> ${text}`;
            } else {
                messageDiv.innerHTML = `<strong>${teacherName}:</strong> ${text}`;
            }
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function generateAIResponse(question) {
            // Find matching response
            for (const [key, response] of Object.entries(aiResponses)) {
                if (question.includes(key.toLowerCase()) || key.toLowerCase().includes(question)) {
                    return response;
                }
            }
            
            // Default responses for common question patterns
            if (question.includes('nh·ªãp') || question.includes('4/4')) {
                return "ƒê√≥ l√† c√¢u h·ªèi hay v·ªÅ nh·ªãp 4/4! Nh·ªãp 4/4 l√† nh·ªãp c∆° b·∫£n nh·∫•t trong √¢m nh·∫°c, gi·ªëng nh∆∞ nh·ªãp ƒë·∫≠p c·ªßa tr√°i tim em v·∫≠y. Em c√≥ th·ªÉ th·ª≠ ƒë·∫øm 1-2-3-4 v√† c·∫£m nh·∫≠n xem! üíìüéµ";
            }
            
            if (question.includes('ph√°ch')) {
                return "Ph√°ch l√† ƒë∆°n v·ªã th·ªùi gian trong √¢m nh·∫°c, gi·ªëng nh∆∞ ti·∫øng tick-tock c·ªßa ƒë·ªìng h·ªì! Trong nh·ªãp 4/4 c√≥ 4 ph√°ch, v√† ph√°ch ƒë·∫ßu ti√™n lu√¥n m·∫°nh nh·∫•t ƒë·ªÉ ƒë√°nh d·∫•u b·∫Øt ƒë·∫ßu √¥ nh·ªãp m·ªõi. ‚è∞üé∂";
            }
            
            if (question.includes('c√°ch') || question.includes('l√†m sao')) {
                return "ƒê·ªÉ h·ªçc nh·ªãp 4/4, em h√£y b·∫Øt ƒë·∫ßu b·∫±ng c√°ch v·ªó tay theo nh·ªãp 1-2-3-4, trong ƒë√≥ ti·∫øng v·ªó s·ªë 1 m·∫°nh nh·∫•t. Sau ƒë√≥ th·ª≠ v·ªõi nh·ªØng b√†i h√°t em y√™u th√≠ch! üëèüéµ";
            }
            
            // Generic helpful response
            return "C√¢u h·ªèi th√∫ v·ªã! V·ªÅ nh·ªãp 4/4, c√¥ khuy√™n em n√™n th·ª±c h√†nh nhi·ªÅu b·∫±ng c√°ch nghe nh·∫°c v√† ƒë·∫øm nh·ªãp. Em c√≥ th·ªÉ h·ªèi c√¥ v·ªÅ ph√°ch m·∫°nh, ph√°ch nh·∫π, c√°ch ƒë√°nh nh·ªãp, ho·∫∑c v√≠ d·ª• v·ªÅ c√°c b√†i h√°t nh·ªãp 4/4 nh√©! üéº‚ú®";
        }



        // Conducting diagram functions
        function toggleConducting() {
            const button = document.getElementById('conductingBtnText');
            const svg = document.querySelector('.conducting-pattern svg');
            const hand = document.getElementById('conductorHand');
            
            if (!isConducting) {
                // Initialize audio context on first user interaction
                if (!audioContext) {
                    initAudioContext();
                }
                
                // Start conducting
                isConducting = true;
                button.textContent = '‚è∏Ô∏è D·ª´ng ƒê√°nh Nh·ªãp';
                button.parentElement.classList.remove('btn-primary');
                button.parentElement.classList.add('btn-secondary');
                
                // Update animation duration based on tempo
                const duration = (60 / conductingTempo) * 4; // 4 beats per cycle
                const animateMotion = hand.querySelector('animateMotion');
                animateMotion.setAttribute('dur', duration + 's');
                
                svg.classList.add('conducting-active');
                svg.classList.remove('conducting-paused');
                
                // Start beat indicator and sound system
                startConductingBeats();
                
                // Restart animation
                animateMotion.beginElement();
                
            } else {
                // Stop conducting
                isConducting = false;
                button.textContent = '‚ñ∂Ô∏è B·∫Øt ƒê·∫ßu ƒê√°nh Nh·ªãp';
                button.parentElement.classList.remove('btn-secondary');
                button.parentElement.classList.add('btn-primary');
                
                svg.classList.add('conducting-paused');
                svg.classList.remove('conducting-active');
                
                // Stop beat indicators and sounds
                stopConductingBeats();
            }
        }

        function startConductingBeats() {
            let beatIndex = 0;
            const beatInterval = (60 / conductingTempo) * 1000; // Convert to milliseconds
            
            conductingAnimation = setInterval(() => {
                // Reset all indicators
                document.querySelectorAll('#beatIndicators circle').forEach(indicator => {
                    indicator.classList.remove('beat-indicator-active');
                });
                
                // Activate current beat indicator
                const currentIndicator = document.getElementById(`indicator${beatIndex + 1}`);
                currentIndicator.classList.add('beat-indicator-active');
                
                // Play sound based on beat strength
                let beatType;
                switch(beatIndex) {
                    case 0: // Beat 1 - Strong
                        beatType = 'strong';
                        break;
                    case 2: // Beat 3 - Medium
                        beatType = 'medium';
                        break;
                    case 1: // Beat 2 - Weak
                    case 3: // Beat 4 - Weak
                        beatType = 'weak';
                        break;
                }
                playBeatSound(beatType);
                
                beatIndex = (beatIndex + 1) % 4;
            }, beatInterval);
        }

        function stopConductingBeats() {
            if (conductingAnimation) {
                clearInterval(conductingAnimation);
                conductingAnimation = null;
            }
            
            // Reset all indicators
            document.querySelectorAll('#beatIndicators circle').forEach(indicator => {
                indicator.classList.remove('beat-indicator-active');
            });
        }

        function resetConducting() {
            if (isConducting) {
                toggleConducting();
            }
            
            // Reset tempo to default
            conductingTempo = 80;
            document.getElementById('conductingTempo').value = 80;
            document.getElementById('conductingTempoDisplay').textContent = '80 BPM';
        }

        function setConductingTempo(newTempo) {
            conductingTempo = newTempo;
            document.getElementById('conductingTempo').value = newTempo;
            document.getElementById('conductingTempoDisplay').textContent = newTempo + ' BPM';
            
            // If conducting is active, restart with new tempo
            if (isConducting) {
                const hand = document.getElementById('conductorHand');
                const duration = (60 / conductingTempo) * 4;
                const animateMotion = hand.querySelector('animateMotion');
                animateMotion.setAttribute('dur', duration + 's');
                animateMotion.beginElement();
                
                // Restart beat system with new tempo
                stopConductingBeats();
                startConductingBeats();
            }
        }

        function updateConductingTempo() {
            conductingTempo = document.getElementById('conductingTempo').value;
            document.getElementById('conductingTempoDisplay').textContent = conductingTempo + ' BPM';
            
            // If conducting is active, update the animation
            if (isConducting) {
                const hand = document.getElementById('conductorHand');
                const animateMotion = hand.querySelector('animateMotion');
                const duration = (60 / conductingTempo) * 4; // 4 beats per cycle
                animateMotion.setAttribute('dur', duration + 's');
                
                // Restart animation with new tempo
                animateMotion.beginElement();
            }
        }



        function downloadQR() {
            const qrImage = document.querySelector('.qr-code');
            if (!qrImage || !qrImage.src) {
                // Create a custom notification instead of alert
                showNotification('QR code kh√¥ng kh·∫£ d·ª•ng ƒë·ªÉ t·∫£i xu·ªëng', 'error');
                return;
            }
            
            // Create download link
            const link = document.createElement('a');
            link.href = qrImage.src;
            link.download = 'QR-Ung-Ho-Tuan-Anh.png';
            link.target = '_blank';
            
            // Trigger download
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('ƒêang t·∫£i QR code...', 'success');
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? 'linear-gradient(135deg, #f56565 0%, #e53e3e 100%)' : 'linear-gradient(135deg, #48bb78 0%, #38a169 100%)'};
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                font-weight: 600;
                animation: slideInRight 0.3s ease;
            `;
            notification.textContent = message;
            
            // Add animation keyframes if not already added
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideInRight {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOutRight {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Game functions
        function showGameInstructions() {
            showGameScreen('gameInstructions');
        }

        function showGameHome() {
            showGameScreen('gameHome');
            updatePackageDisplay();
        }

        function showGameScreen(screenId) {
            document.querySelectorAll('.game-screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function updatePackageDisplay() {
            gameState.completedPackages.forEach(packageName => {
                const packageElement = document.getElementById(packageName + 'Package');
                if (packageElement) {
                    packageElement.classList.add('completed');
                }
            });
        }

        function startGamePackage(packageName) {
            if (gameState.completedPackages.includes(packageName)) {
                showNotification('G√≥i n√†y ƒë√£ ho√†n th√†nh!', 'info');
                return;
            }

            gameState.currentPackage = packageName;
            gameState.currentQuestionIndex = 0;
            gameState.lives = 3;
            gameState.selectedAnswer = -1;
            
            // Shuffle questions for this package
            const questions = [...gameQuestions[packageName]];
            gameState.currentQuestions = questions.sort(() => Math.random() - 0.5);
            
            showGameScreen('gamePlay');
            updateGameHeader();
            loadGameQuestion();
        }

        function updateGameHeader() {
            const packageTitles = {
                'easy': 'G√≥i D·ªÖ',
                'medium': 'G√≥i Trung B√¨nh', 
                'hard': 'G√≥i Kh√≥'
            };
            
            document.getElementById('currentPackageTitle').textContent = packageTitles[gameState.currentPackage];
            document.getElementById('questionCounter').textContent = `C√¢u ${gameState.currentQuestionIndex + 1}/5`;
            
            // Update lives display
            const hearts = '‚ù§Ô∏è'.repeat(gameState.lives) + 'üñ§'.repeat(3 - gameState.lives);
            document.getElementById('livesDisplay').textContent = hearts;
        }

        function loadGameQuestion() {
            const question = gameState.currentQuestions[gameState.currentQuestionIndex];
            const questionText = document.getElementById('gameQuestionText');
            const optionsContainer = document.getElementById('gameQuestionOptions');
            
            questionText.textContent = question.question;
            optionsContainer.innerHTML = '';
            
            gameState.selectedAnswer = -1;
            document.getElementById('gameSubmitBtn').disabled = true;
            document.getElementById('gameContinueBtn').style.display = 'none';
            document.getElementById('gameResult').innerHTML = '';
            
            if (question.type === 'multiple_choice' || question.type === 'true_false' || question.type === 'fill_blank') {
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'game-option';
                    optionDiv.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                    optionDiv.onclick = () => selectGameOption(index);
                    optionsContainer.appendChild(optionDiv);
                });
            } else if (question.type === 'matching') {
                // Create matching interface
                const matchingContainer = document.createElement('div');
                matchingContainer.className = 'matching-container';
                matchingContainer.style.cssText = `
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 20px;
                    margin: 20px 0;
                `;
                
                const leftColumn = document.createElement('div');
                leftColumn.className = 'matching-left';
                const rightColumn = document.createElement('div');
                rightColumn.className = 'matching-right';
                
                question.pairs.forEach((pair, index) => {
                    const leftItem = document.createElement('div');
                    leftItem.className = 'matching-item left-item';
                    leftItem.textContent = pair.left;
                    leftItem.dataset.index = index;
                    leftItem.onclick = () => selectMatchingItem(leftItem, 'left');
                    leftColumn.appendChild(leftItem);
                    
                    const rightItem = document.createElement('div');
                    rightItem.className = 'matching-item right-item';
                    rightItem.textContent = pair.right;
                    rightItem.dataset.index = index;
                    rightItem.onclick = () => selectMatchingItem(rightItem, 'right');
                    rightColumn.appendChild(rightItem);
                });
                
                matchingContainer.appendChild(leftColumn);
                matchingContainer.appendChild(rightColumn);
                optionsContainer.appendChild(matchingContainer);
                
                // Add matching styles
                const matchingStyles = `
                    .matching-item {
                        background: rgba(255, 255, 255, 0.9);
                        border: 2px solid rgba(159, 122, 234, 0.3);
                        border-radius: 10px;
                        padding: 15px;
                        margin: 8px 0;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        text-align: center;
                        font-weight: 500;
                    }
                    .matching-item:hover {
                        border-color: #9f7aea;
                        background: rgba(245, 240, 255, 0.95);
                    }
                    .matching-item.selected {
                        border-color: #667eea;
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                    }
                    .matching-item.matched {
                        border-color: #48bb78;
                        background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
                        color: white;
                        cursor: not-allowed;
                    }
                `;
                
                if (!document.querySelector('#matching-styles')) {
                    const style = document.createElement('style');
                    style.id = 'matching-styles';
                    style.textContent = matchingStyles;
                    document.head.appendChild(style);
                }
                
                gameState.matchingState = {
                    selectedLeft: null,
                    selectedRight: null,
                    matches: []
                };
            }
        }

        function selectGameOption(index) {
            // Remove previous selections
            document.querySelectorAll('.game-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Select current option
            document.querySelectorAll('.game-option')[index].classList.add('selected');
            gameState.selectedAnswer = index;
            document.getElementById('gameSubmitBtn').disabled = false;
        }

        function selectMatchingItem(item, side) {
            if (item.classList.contains('matched')) return;
            
            // Remove previous selection from same side
            document.querySelectorAll(`.${side}-item.selected`).forEach(el => {
                el.classList.remove('selected');
            });
            
            item.classList.add('selected');
            
            if (side === 'left') {
                gameState.matchingState.selectedLeft = item;
            } else {
                gameState.matchingState.selectedRight = item;
            }
            
            // Check if both sides are selected
            if (gameState.matchingState.selectedLeft && gameState.matchingState.selectedRight) {
                const leftIndex = parseInt(gameState.matchingState.selectedLeft.dataset.index);
                const rightIndex = parseInt(gameState.matchingState.selectedRight.dataset.index);
                
                if (leftIndex === rightIndex) {
                    // Correct match
                    gameState.matchingState.selectedLeft.classList.remove('selected');
                    gameState.matchingState.selectedRight.classList.remove('selected');
                    gameState.matchingState.selectedLeft.classList.add('matched');
                    gameState.matchingState.selectedRight.classList.add('matched');
                    
                    gameState.matchingState.matches.push(leftIndex);
                    playGameSound('correct');
                    
                    // Check if all matches are complete
                    if (gameState.matchingState.matches.length === 4) {
                        gameState.selectedAnswer = 'correct';
                        document.getElementById('gameSubmitBtn').disabled = false;
                    }
                } else {
                    // Incorrect match - flash red and reset
                    gameState.matchingState.selectedLeft.style.background = 'linear-gradient(135deg, #f56565 0%, #e53e3e 100%)';
                    gameState.matchingState.selectedRight.style.background = 'linear-gradient(135deg, #f56565 0%, #e53e3e 100%)';
                    
                    setTimeout(() => {
                        gameState.matchingState.selectedLeft.style.background = '';
                        gameState.matchingState.selectedRight.style.background = '';
                        gameState.matchingState.selectedLeft.classList.remove('selected');
                        gameState.matchingState.selectedRight.classList.remove('selected');
                    }, 500);
                    
                    playGameSound('incorrect');
                }
                
                gameState.matchingState.selectedLeft = null;
                gameState.matchingState.selectedRight = null;
            }
        }

        function submitGameAnswer() {
            const question = gameState.currentQuestions[gameState.currentQuestionIndex];
            const isCorrect = (gameState.selectedAnswer === question.correct) || 
                             (question.type === 'matching' && gameState.selectedAnswer === 'correct');
            
            // Disable all options
            document.querySelectorAll('.game-option').forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            const resultDiv = document.getElementById('gameResult');
            
            if (isCorrect) {
                // Correct answer
                if (question.type !== 'matching') {
                    document.querySelectorAll('.game-option')[question.correct].classList.add('correct');
                }
                resultDiv.innerHTML = 'üéâ Ch√≠nh x√°c! Tuy·ªát v·ªùi!';
                resultDiv.className = 'game-result correct';
                playGameSound('correct');
                
                document.getElementById('gameSubmitBtn').style.display = 'none';
                document.getElementById('gameContinueBtn').style.display = 'inline-block';
            } else {
                // Incorrect answer
                gameState.lives--;
                updateGameHeader();
                
                if (question.type !== 'matching') {
                    if (gameState.selectedAnswer !== -1) {
                        document.querySelectorAll('.game-option')[gameState.selectedAnswer].classList.add('incorrect');
                    }
                    document.querySelectorAll('.game-option')[question.correct].classList.add('correct');
                }
                
                playGameSound('incorrect');
                
                if (gameState.lives > 0) {
                    resultDiv.innerHTML = `‚ùå Sai r·ªìi! C√≤n ${gameState.lives} l·∫ßn th·ª≠. H√£y th·ª≠ l·∫°i!`;
                    resultDiv.className = 'game-result incorrect';
                    
                    // Reset for retry
                    setTimeout(() => {
                        document.querySelectorAll('.game-option').forEach(opt => {
                            opt.style.pointerEvents = 'auto';
                            opt.classList.remove('selected', 'correct', 'incorrect');
                        });
                        gameState.selectedAnswer = -1;
                        document.getElementById('gameSubmitBtn').disabled = true;
                        resultDiv.innerHTML = '';
                        
                        // Reset matching state if needed
                        if (question.type === 'matching') {
                            document.querySelectorAll('.matching-item').forEach(item => {
                                item.classList.remove('selected', 'matched');
                                item.style.background = '';
                            });
                            gameState.matchingState = {
                                selectedLeft: null,
                                selectedRight: null,
                                matches: []
                            };
                        }
                    }, 2000);
                } else {
                    // No more lives - show answer and continue
                    resultDiv.innerHTML = `üíî H·∫øt l∆∞·ª£t th·ª≠! ƒê√°p √°n ƒë√∫ng ƒë√£ ƒë∆∞·ª£c hi·ªÉn th·ªã.`;
                    resultDiv.className = 'game-result incorrect';
                    
                    document.getElementById('gameSubmitBtn').style.display = 'none';
                    document.getElementById('gameContinueBtn').style.display = 'inline-block';
                }
            }
        }

        function nextGameQuestion() {
            gameState.currentQuestionIndex++;
            gameState.lives = 3; // Reset lives for next question
            
            if (gameState.currentQuestionIndex >= 5) {
                // Package completed
                gameState.completedPackages.push(gameState.currentPackage);
                playCompletionSound();
                showGameScreen('gameComplete');
            } else {
                // Load next question
                updateGameHeader();
                loadGameQuestion();
            }
        }

        function playGameSound(type) {
            if (!isAudioEnabled || !audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (type === 'correct') {
                // Happy ascending notes
                oscillator.frequency.setValueAtTime(523, audioContext.currentTime); // C5
                oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.1); // E5
                oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.2); // G5
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.4);
            } else if (type === 'incorrect') {
                // Sad descending notes
                oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(350, audioContext.currentTime + 0.15);
                oscillator.frequency.setValueAtTime(300, audioContext.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            }
        }

        function playCompletionSound() {
            if (!isAudioEnabled || !audioContext) return;
            
            // Victory fanfare
            const notes = [523, 659, 784, 1047]; // C5, E5, G5, C6
            notes.forEach((freq, index) => {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                }, index * 150);
            });
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995b935ec0e4d173',t:'MTc2MTY2NjQ4OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
